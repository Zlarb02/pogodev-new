<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Étienne Pogoda | Redirection</title>
    <script type="text/javascript">
      // Configuration pour GitHub Pages avec SPA
      var pathSegmentsToKeep = 1; // Garde le segment "pogodev-new" dans le path
      var l = window.location;
      var repositoryName = "pogodev-new"; // Nom du dépôt GitHub

      // Vérifier si nous sommes sur un domaine personnalisé
      var isCustomDomain =
        !l.hostname.includes("github.io") && l.hostname !== "localhost";

      // Construction de la redirection avec préservation du chemin d'URL
      // Si domaine personnalisé, ne pas ajouter le nom du repo
      var path = l.pathname;
      if (!isCustomDomain) {
        // Sur github.io, on garde le segment du repo et on reconstruit le path
        path = l.pathname
          .split("/")
          .slice(pathSegmentsToKeep + 1)
          .join("/");
      }

      var queryParams = l.search ? l.search.replace(/&/g, "~and~") : "";
      var hashFragment = l.hash ? l.hash.slice(1) : "";

      // L'URL vers laquelle rediriger
      var redirectUrl =
        l.protocol +
        "//" +
        l.hostname +
        (l.port ? ":" + l.port : "") +
        (isCustomDomain ? "/" : "/" + repositoryName + "/") +
        (path ? "?path=" + path : "") +
        (queryParams ? "&" + queryParams.slice(1).replace(/&/g, "~and~") : "") +
        (hashFragment ? "#" + hashFragment : "");

      // Stockage de l'URL pour que index.html puisse y accéder
      sessionStorage.redirect = redirectUrl;

      // Redirection vers la page principale
      window.location.replace(redirectUrl);
    </script>
  </head>
  <body>
    <h1>Redirection en cours...</h1>
    <p>
      Si vous n'êtes pas redirigé automatiquement, <a href="/">cliquez ici</a>.
    </p>
  </body>
</html>
